{"version":3,"sources":["utils/IntlDateTimeFormats.ts","App.tsx","utils/shuffle.ts","serviceWorker.ts","index.tsx"],"names":["localeLongDateAndTime","Intl","DateTimeFormat","weekday","month","day","year","hour","minute","second","timeZoneName","localeDate","pluralize","addSingularRule","Screen","styled","div","Nav","nav","Main","main","navigationHeight","Masthead","Title","h1","LastUpdated","SearchBar","label","SearchSummary","SearchInput","input","LocalityName","strong","LocalitySummary","isTotal","undefined","CompletedBar","randomHues","a","i","length","j","Math","floor","random","shuffle","report","localities","map","_","array","localityColors","reduce","result","locality","id","App","windowWidth","useWindowWidth","useState","setNavigationHeight","filter","setFilter","filteredLocalities","ballotsCounted","ballotsExpected","name","match","RegExp","electionDate","format","Date","election","date","lastUpdated","useEffect","document","getElementById","getBoundingClientRect","height","type","placeholder","maxLength","onChange","event","currentTarget","value","percentComplete","toFixed","key","toLocaleString","style","width","backgroundColor","onClick","Boolean","window","location","hostname","ReactDOM","render","StrictMode","navigator","serviceWorker","ready","then","registration","unregister","catch","error","console","message"],"mappings":"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","file":"static/js/main.32d13149.chunk.js","sourcesContent":["export const localeLongDateAndTime = new Intl.DateTimeFormat('en', {\n  weekday: 'long',\n  month: 'long',\n  day: 'numeric',\n  year: 'numeric',\n  hour: 'numeric',\n  minute: 'numeric',\n  second: 'numeric',\n  timeZoneName: 'short',\n})\n\nexport const localeWeedkayAndDate = new Intl.DateTimeFormat('en', {\n  weekday: 'long',\n  month: 'long',\n  day: 'numeric',\n  year: 'numeric',\n})\n\nexport const localeDate = new Intl.DateTimeFormat('en', {\n  month: 'long',\n  day: 'numeric',\n  year: 'numeric',\n})\n","import React, { useEffect, useState } from 'react'\nimport styled from 'styled-components'\nimport pluralize from 'pluralize'\nimport { useWindowWidth } from '@react-hook/window-size'\n\nimport { localeDate, localeLongDateAndTime } from './utils/IntlDateTimeFormats'\n\nimport report from './data/virgina-report.json'\nimport { Dictionary } from './types'\nimport shuffle from './utils/shuffle'\n\npluralize.addSingularRule('localities', 'locality')\n\nconst Screen = styled.div``\nconst Nav = styled.nav`\n  position: absolute;\n  z-index: 100;\n  top: 0;\n  right: 0;\n  left: 0;\n  padding: 0.5rem;\n  background: #3e4e6d;\n  color: #ffffff;\n  @media (min-width: 767px) {\n    padding: 1rem;\n  }\n`\nconst Main = styled.main<{ navigationHeight: number }>`\n  padding-top: ${({ navigationHeight }) =>\n    navigationHeight ? `${navigationHeight}px` : '150px'};\n`\nconst Masthead = styled.div`\n  display: flex;\n  flex-direction: column;\n  align-items: flex-start;\n  justify-content: space-between;\n  @media (min-width: 767px) {\n    flex-direction: row;\n  }\n`\nconst Title = styled.h1`\n  flex: 1;\n  margin: 0;\n`\nconst LastUpdated = styled.div`\n  margin-top: 0.25em;\n  font-size: 0.8rem;\n  @media (min-width: 767px) {\n    margin-top: 0;\n  }\n`\nconst SearchBar = styled.label`\n  display: flex;\n  flex-direction: column;\n  justify-content: space-between;\n  @media (min-width: 767px) {\n    flex-direction: row;\n    align-items: center;\n  }\n`\nconst SearchSummary = styled.div`\n  flex: 1;\n  margin: 0.5em 0;\n  @media (min-width: 767px) {\n    margin: 0 1em 0 0;\n  }\n`\nconst SearchInput = styled.input`\n  width: 100%;\n  padding: 0.25rem;\n  @media (min-width: 767px) {\n    width: 15em;\n  }\n`\n\nconst LocalityName = styled.strong`\n  font-size: 1.3rem;\n`\n\nconst LocalitySummary = styled.div<{ isTotal: boolean }>`\n  padding: ${({ isTotal }) => (isTotal ? '2rem 0.5rem' : '0.75rem 0.5rem')};\n  border-bottom: ${({ isTotal }) =>\n    isTotal ? '1px solid #cccccc' : undefined};\n  margin-bottom: ${({ isTotal }) => (isTotal ? '0.5rem' : undefined)};\n  background: ${({ isTotal }) => (isTotal ? '#eeeeee' : undefined)};\n  @media (min-width: 767px) {\n    padding: ${({ isTotal }) => (isTotal ? '2rem 1rem' : '1rem')};\n  }\n\n  p {\n    margin: 0 0 0.2rem;\n  }\n`\nconst CompletedBar = styled.div`\n  position: relative;\n  font-size: 0.8rem;\n  font-weight: 600;\n  div {\n    padding: 0 0.3rem;\n    border-radius: 2rem;\n    line-height: 1.4em;\n  }\n  div:first-child {\n    position: absolute;\n    right: 0;\n    bottom: 0;\n    left: 0;\n    background: #dddddd;\n  }\n  div:last-child {\n    position: relative;\n    z-index: 1;\n    overflow: hidden;\n    background: #000000;\n    color: #ffffff;\n    text-align: right;\n  }\n`\n// TODO: Move color generation into report json so that localities maintain the same color.\nconst randomHues = shuffle(\n  report.localities.map((_, i, array) => 360 * ((i + 1) / array.length))\n)\nconst localityColors = report.localities.reduce<Dictionary<string>>(\n  (result, locality, i) => ({\n    ...result,\n    [locality.id]: `hsl(${randomHues[i]} 40% 40% / 1)`,\n  }),\n  {}\n)\n\ninterface Locality {\n  id: string\n  name: string\n  ballotsCounted: number\n  ballotsExpected: number\n}\n\nconst App: React.FunctionComponent = () => {\n  const windowWidth = useWindowWidth()\n  const [navigationHeight, setNavigationHeight] = useState<number>(0)\n  const [filter, setFilter] = useState('')\n  const reportTotal = report.localities.reduce<Locality>(\n    (result, locality) => ({\n      ...result,\n      ballotsCounted: result.ballotsCounted + locality.ballotsCounted,\n      ballotsExpected: result.ballotsExpected + locality.ballotsExpected,\n    }),\n    {\n      id: 'total',\n      name: 'State of Virginia',\n      ballotsCounted: 0,\n      ballotsExpected: 0,\n    }\n  )\n  const displayLocalities = [reportTotal, ...report.localities]\n  const filteredLocalities = displayLocalities.filter((locality) =>\n    locality.name.match(new RegExp(filter, 'gi'))\n  )\n  const electionDate = localeDate.format(new Date(report.election.date))\n  const lastUpdated = localeLongDateAndTime.format(new Date(report.lastUpdated))\n\n  useEffect(() => {\n    setNavigationHeight(\n      document.getElementById('navigation')?.getBoundingClientRect().height ?? 0\n    )\n  }, [windowWidth])\n\n  return (\n    <Screen>\n      <Nav id=\"navigation\">\n        <Masthead>\n          <Title>{report.name}</Title>\n          <LastUpdated>Last updated: {lastUpdated}</LastUpdated>\n        </Masthead>\n        <SearchBar>\n          {filter ? (\n            <SearchSummary>\n              Showing {pluralize('locality', filteredLocalities.length, true)}{' '}\n              matching “{filter}” for {electionDate} {report.election.name}\n            </SearchSummary>\n          ) : (\n            <SearchSummary>\n              Showing all{' '}\n              {pluralize('locality', filteredLocalities.length, true)} for{' '}\n              {electionDate} {report.election.name}\n            </SearchSummary>\n          )}\n          <SearchInput\n            type=\"text\"\n            placeholder=\"search by name\"\n            maxLength={30}\n            onChange={(event) => setFilter(event.currentTarget.value)}\n          />\n        </SearchBar>\n      </Nav>\n      <Main navigationHeight={navigationHeight}>\n        {filteredLocalities.map((locality) => {\n          const percentComplete = `${(\n            (locality.ballotsCounted / locality.ballotsExpected) *\n            100\n          ).toFixed(2)}%`\n          return (\n            <LocalitySummary\n              key={locality.id}\n              isTotal={locality.id === 'total'}\n            >\n              <p>\n                <LocalityName>{locality.name}</LocalityName> has counted{' '}\n                {locality.ballotsCounted.toLocaleString('en')} of{' '}\n                {locality.ballotsExpected.toLocaleString('en')} expected ballots\n                {locality.id === 'total' && <strong> in total</strong>}.\n              </p>\n              <CompletedBar>\n                <div>{percentComplete}</div>\n                <div\n                  style={{\n                    width: percentComplete,\n                    backgroundColor: localityColors[locality.id],\n                  }}\n                >\n                  {percentComplete}\n                </div>\n              </CompletedBar>\n            </LocalitySummary>\n          )\n        })}\n        {filteredLocalities.length === 0 && (\n          <button type=\"button\" onClick={() => setFilter('')}>\n            Show all\n          </button>\n        )}\n      </Main>\n    </Screen>\n  )\n}\n\nexport default App\n","/* eslint-disable no-param-reassign */\n/* eslint-disable no-plusplus */\n\n/**\n * Shuffles array in place. ES6 version\n * @param {Array} a items An array containing the items.\n */\nexport default function shuffle<T>(a: Array<T>): Array<T> {\n  for (let i = a.length - 1; i > 0; i--) {\n    const j = Math.floor(Math.random() * (i + 1))\n    ;[a[i], a[j]] = [a[j], a[i]]\n  }\n  return a\n}\n","/* eslint-disable */\n\n// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n)\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void\n  onUpdate?: (registration: ServiceWorkerRegistration) => void\n}\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href)\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config)\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          )\n        })\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config)\n      }\n    })\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then((registration) => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing\n        if (installingWorker == null) {\n          return\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              )\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration)\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.')\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration)\n              }\n            }\n          }\n        }\n      }\n    })\n    .catch((error) => {\n      console.error('Error during service worker registration:', error)\n    })\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then((response) => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type')\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then((registration) => {\n          registration.unregister().then(() => {\n            window.location.reload()\n          })\n        })\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config)\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      )\n    })\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then((registration) => {\n        registration.unregister()\n      })\n      .catch((error) => {\n        console.error(error.message)\n      })\n  }\n}\n","import React from 'react'\nimport ReactDOM from 'react-dom'\nimport './index.css'\nimport App from './App'\nimport * as serviceWorker from './serviceWorker'\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n)\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister()\n"],"sourceRoot":""}